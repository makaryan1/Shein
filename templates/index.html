
<!DOCTYPE html>
<html lang="{{ current_lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ _["Online Shopping"] }} - SHEIN Market</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Header -->
    <header class="temu-header">
        <div class="container">
            <nav class="navbar navbar-expand-lg">
                <div class="d-flex align-items-center justify-content-between w-100">
                    <a class="navbar-brand" href="/">
                        <span class="brand-text">SHEIN Market</span>
                        <small class="brand-subtitle">{{ _["Online Shopping"] }}</small>
                    </a>

                    <div class="search-container mx-4 flex-grow-1">
                        <form action="{{ url_for('search') }}" method="GET" class="position-relative">
                            <input type="text" name="q" class="form-control search-input" placeholder="Найти модную одежду..." required>
                            <button class="btn btn-search" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                    </div>

                    <div class="header-actions d-flex align-items-center gap-3">
                        <div class="language-selector">
                            {% for code, lang in languages.items() %}
                                <a href="{{ url_for('set_language', language=code) }}" 
                                   class="lang-btn {% if code == current_lang %}active{% endif %}"
                                   title="{{ lang['name'] }}">
                                    {{ lang['icon'] }}
                                </a>
                            {% endfor %}
                        </div>

                        {% if session.username %}
                            <div class="dropdown">
                                <button class="btn btn-user dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user-circle me-2"></i>
                                    {{ session.username }}
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="{{ url_for('profile') }}">
                                        <i class="fas fa-user me-2"></i>Профиль
                                    </a></li>
                                    <li><a class="dropdown-item" href="#">
                                        <i class="fas fa-shopping-bag me-2"></i>Мои заказы
                                    </a></li>
                                    <li><a class="dropdown-item" href="#">
                                        <i class="fas fa-heart me-2"></i>Избранное
                                    </a></li>
                                    {% if session.is_admin %}
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item" href="{{ url_for('admin_panel') }}">
                                            <i class="fas fa-cog me-2"></i>Админ-панель
                                        </a></li>
                                    {% endif %}
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="{{ url_for('logout') }}">
                                        <i class="fas fa-sign-out-alt me-2"></i>Выйти
                                    </a></li>
                                </ul>
                            </div>
                        {% else %}
                            <div class="auth-buttons d-flex gap-2">
                                <a href="{{ url_for('login') }}" class="btn btn-outline-light">
                                    <i class="fas fa-sign-in-alt me-1"></i> Войти
                                </a>
                                <a href="{{ url_for('register') }}" class="btn btn-light">
                                    <i class="fas fa-user-plus me-1"></i> Регистрация
                                </a>
                            </div>
                        {% endif %}

                        <a href="{{ url_for('cart') }}" class="cart-btn">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-count">{{ cart_count or 0 }}</span>
                        </a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="container mt-3">
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Hero Banner -->
    <section class="hero-banner">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="hero-title">Модная одежда со скидкой до 90%!</h1>
                    <p class="hero-subtitle">Миллионы стильных товаров по лучшим ценам</p>
                    <button class="btn btn-hero" onclick="scrollToProducts()">
                        <i class="fas fa-shopping-bag me-2"></i>
                        Начать покупки
                    </button>
                </div>
                <div class="col-lg-6">
                    <div class="hero-deals">
                        <div class="deal-badge">
                            <span class="deal-percent">90%</span>
                            <span class="deal-text">СКИДКА</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories-section">
        <div class="container">
            <h2 class="section-title">{{ _["Categories"] }}</h2>
            <div class="categories-grid">
                <div class="category-item" onclick="filterByCategory('Женская одежда')">
                    <i class="fas fa-female"></i>
                    <span>Женская одежда</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Мужская одежда')">
                    <i class="fas fa-male"></i>
                    <span>Мужская одежда</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Обувь')">
                    <i class="fas fa-shoe-prints"></i>
                    <span>Обувь</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Сумки')">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Сумки</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Аксессуары')">
                    <i class="fas fa-gem"></i>
                    <span>Аксессуары</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Красота')">
                    <i class="fas fa-heart"></i>
                    <span>Красота</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Дом')">
                    <i class="fas fa-home"></i>
                    <span>Дом</span>
                </div>
                <div class="category-item" onclick="filterByCategory('Спорт')">
                    <i class="fas fa-dumbbell"></i>
                    <span>Спорт</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products-section" id="products">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Хиты продаж</h2>
                <div class="flash-sale">
                    <i class="fas fa-bolt"></i>
                    <span>Молниеносная распродажа</span>
                </div>
            </div>

            <div class="products-grid" id="products-grid">
                {% for product in products %}
                <div class="product-card" data-category="{{ product.category }}">
                    <div class="product-image">
                        <img src="{{ product.image }}" alt="{{ product.name }}" loading="lazy">
                        <div class="product-badges">
                            {% if product.discount > 0 %}
                                <span class="badge-sale">-{{ product.discount }}%</span>
                            {% endif %}
                            <span class="badge-free-shipping">Бесплатная доставка</span>
                        </div>
                        <button class="btn-wishlist" onclick="addToWishlist('{{ product.id }}')">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>

                    <div class="product-info">
                        <h5 class="product-name">{{ product.name }}</h5>
                        <div class="product-rating">
                            <span class="stars">
                                {% for i in range(5) %}
                                    <i class="fas fa-star{% if i >= product.rating|round|int %} text-muted{% endif %}"></i>
                                {% endfor %}
                            </span>
                            <span class="rating-count">({{ product.rating }})</span>
                        </div>

                        <div class="product-price">
                            {% if product.discount > 0 %}
                                <span class="current-price">${{ "%.2f"|format(product.price * (1 - product.discount / 100)) }}</span>
                                <span class="old-price">${{ "%.2f"|format(product.price) }}</span>
                            {% else %}
                                <span class="current-price">${{ "%.2f"|format(product.price) }}</span>
                            {% endif %}
                        </div>

                        <div class="product-actions">
                            <a href="{{ url_for('add_to_cart', product_id=product.id) }}" class="btn btn-add-cart">
                                <i class="fas fa-shopping-cart"></i>
                                {{ _["Add to Cart"] }}
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Load More Button -->
            <div class="text-center mt-4">
                <button class="btn btn-gradient" onclick="loadMoreProducts()">
                    <i class="fas fa-plus me-2"></i>
                    Показать еще
                </button>
            </div>
        </div>
    </section>

    <!-- Flash Sale Timer -->
    <section class="flash-sale-timer">
        <div class="container">
            <div class="timer-content">
                <h3>⚡ Молниеносная распродажа заканчивается через:</h3>
                <div class="countdown" id="countdown">
                    <div class="time-unit">
                        <span class="time-number" id="hours">12</span>
                        <span class="time-label">часов</span>
                    </div>
                    <div class="time-unit">
                        <span class="time-number" id="minutes">34</span>
                        <span class="time-label">минут</span>
                    </div>
                    <div class="time-unit">
                        <span class="time-number" id="seconds">56</span>
                        <span class="time-label">секунд</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="temu-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <h5>О нас</h5>
                    <ul>
                        <li><a href="#">О компании</a></li>
                        <li><a href="#">Карьера</a></li>
                        <li><a href="#">Пресса</a></li>
                        <li><a href="#">Блог</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Покупателям</h5>
                    <ul>
                        <li><a href="#">Как заказать</a></li>
                        <li><a href="#">Доставка</a></li>
                        <li><a href="#">Возврат</a></li>
                        <li><a href="#">Гарантия</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Поддержка</h5>
                    <ul>
                        <li><a href="#">Центр помощи</a></li>
                        <li><a href="#">Связаться с нами</a></li>
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Чат с поддержкой</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Социальные сети</h5>
                    <div class="social-links">
                        <a href="#" title="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="#" title="TikTok"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 SHEIN Market. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Countdown Timer
        function updateCountdown() {
            const now = new Date().getTime();
            const saleEnd = new Date(now + 24 * 60 * 60 * 1000).getTime(); // 24 hours from now
            const distance = saleEnd - now;

            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }

        // Update countdown every second
        setInterval(updateCountdown, 1000);
        updateCountdown();

        // Smooth scroll to products
        function scrollToProducts() {
            document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
        }

        // Filter products by category
        function filterByCategory(category) {
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                if (product.dataset.category === category) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
            
            // Smooth scroll to products
            scrollToProducts();
        }

        // Add to wishlist
        function addToWishlist(productId) {
            const btn = event.target.closest('.btn-wishlist');
            const icon = btn.querySelector('i');
            
            if (icon.classList.contains('far')) {
                icon.classList.remove('far');
                icon.classList.add('fas');
                btn.style.background = '#fd79a8';
                btn.style.color = 'white';
            } else {
                icon.classList.remove('fas');
                icon.classList.add('far');
                btn.style.background = 'rgba(255, 255, 255, 0.9)';
                btn.style.color = '#636e72';
            }
        }

        // Load more products
        function loadMoreProducts() {
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<div class="loading"></div> Загрузка...';
            btn.disabled = true;
            
            // Simulate loading delay
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                // In a real implementation, you would fetch more products here
                alert('Функция "Показать еще" будет реализована позже');
            }, 1000);
        }

        // Add animation on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animation = 'fadeInUp 0.6s ease-out';
                }
            });
        }, observerOptions);

        // Observe all product cards
        document.querySelectorAll('.product-card').forEach(card => {
            observer.observe(card);
        });

        // Enhanced cart functionality
        document.addEventListener('DOMContentLoaded', function() {
            const cartButtons = document.querySelectorAll('.btn-add-cart');
            
            cartButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const originalText = this.innerHTML;
                    this.innerHTML = '<div class="loading"></div> Добавляем...';
                    this.disabled = true;
                    
                    // Simulate adding to cart
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-check"></i> Добавлено!';
                        this.style.background = '#96ceb4';
                        
                        // Update cart count
                        const cartCount = document.querySelector('.cart-count');
                        const currentCount = parseInt(cartCount.textContent) || 0;
                        cartCount.textContent = currentCount + 1;
                        
                        // Reset button after 2 seconds
                        setTimeout(() => {
                            this.innerHTML = originalText;
                            this.disabled = false;
                            this.style.background = '';
                        }, 2000);
                        
                        // Navigate to the actual add to cart URL
                        window.location.href = this.href;
                    }, 800);
                });
            });
        });
    </script>
</body>
</html>
